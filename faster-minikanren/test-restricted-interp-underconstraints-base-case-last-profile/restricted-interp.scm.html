<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html;charset=utf-8">
<title>restricted-interp.scm</title>
<style type="text/css">
* { border: 0; margin: 0; outline: 0; padding: 0; vertical-align: baseline; }
code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1rem; }
html { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; }
table { border-collapse: collapse; border-spacing: 0; }
body { padding: 1rem; }
h1, h2, h3, h4 { line-height: 1.25; margin-bottom: 0.5rem; }
h1 { font-size: 1.296rem; }
h2 { font-size: 1.215rem; }
h3 { font-size: 1.138rem; }
h4 { font-size: 1.067rem; }
html { font-family: monospace, monospace; font-size: 1rem; }
p { margin-bottom: 1.25rem; }
.pc0 { background-color: #111111; color: white; white-space: nowrap; }
.pc1 { background-color: #607D8B; color: white; white-space: nowrap; }
.pc2 { background-color: #9C27B0; color: black; white-space: nowrap; }
.pc3 { background-color: #673AB7; color: white; white-space: nowrap; }
.pc4 { background-color: #3F51B5; color: white; white-space: nowrap; }
.pc5 { background-color: #2196F3; color: black; white-space: nowrap; }
.pc6 { background-color: #00BCD4; color: black; white-space: nowrap; }
.pc7 { background-color: #4CAF50; color: black; white-space: nowrap; }
.pc8 { background-color: #CDDC39; color: black; white-space: nowrap; }
.pc9 { background-color: #FFEB3B; color: black; white-space: nowrap; }
.pc10 { background-color: #FFC107; color: black; white-space: nowrap; }
.pc11 { background-color: #FF9800; color: black; white-space: nowrap; }
.pc12 { background-color: #F44336; color: white; white-space: nowrap; }
</style>
</head>
<body class=pc0>
<h1 style="margin-bottom: 1rem">restricted-interp.scm<span style="opacity: 0.5"> on Mon Jun 12 01:41:21 2023</span></h1>
<table><tr><td style="color: #666666; font-weight: bold; padding-right: 1rem; text-align: right"><pre>
<span id=line1>1
</span><span id=line2>2
</span><span id=line3>3
</span><span id=line4>4
</span><span id=line5>5
</span><span id=line6>6
</span><span id=line7>7
</span><span id=line8>8
</span><span id=line9>9
</span><span id=line10>10
</span><span id=line11>11
</span><span id=line12>12
</span><span id=line13>13
</span><span id=line14>14
</span><span id=line15>15
</span><span id=line16>16
</span><span id=line17>17
</span><span id=line18>18
</span><span id=line19>19
</span><span id=line20>20
</span><span id=line21>21
</span><span id=line22>22
</span><span id=line23>23
</span><span id=line24>24
</span><span id=line25>25
</span><span id=line26>26
</span><span id=line27>27
</span><span id=line28>28
</span><span id=line29>29
</span><span id=line30>30
</span><span id=line31>31
</span><span id=line32>32
</span><span id=line33>33
</span><span id=line34>34
</span><span id=line35>35
</span><span id=line36>36
</span><span id=line37>37
</span><span id=line38>38
</span><span id=line39>39
</span><span id=line40>40
</span><span id=line41>41
</span><span id=line42>42
</span><span id=line43>43
</span><span id=line44>44
</span><span id=line45>45
</span><span id=line46>46
</span><span id=line47>47
</span><span id=line48>48
</span><span id=line49>49
</span><span id=line50>50
</span><span id=line51>51
</span><span id=line52>52
</span><span id=line53>53
</span><span id=line54>54
</span><span id=line55>55
</span><span id=line56>56
</span><span id=line57>57
</span><span id=line58>58
</span><span id=line59>59
</span><span id=line60>60
</span><span id=line61>61
</span><span id=line62>62
</span><span id=line63>63
</span><span id=line64>64
</span><span id=line65>65
</span><span id=line66>66
</span><span id=line67>67
</span><span id=line68>68
</span><span id=line69>69
</span><span id=line70>70
</span><span id=line71>71
</span><span id=line72>72
</span><span id=line73>73
</span><span id=line74>74
</span><span id=line75>75
</span><span id=line76>76
</span><span id=line77>77
</span><span id=line78>78
</span><span id=line79>79
</span><span id=line80>80
</span><span id=line81>81
</span><span id=line82>82
</span><span id=line83>83
</span><span id=line84>84
</span><span id=line85>85
</span><span id=line86>86
</span><span id=line87>87
</span><span id=line88>88
</span><span id=line89>89
</span><span id=line90>90
</span><span id=line91>91
</span><span id=line92>92
</span><span id=line93>93
</span><span id=line94>94
</span><span id=line95>95
</span><span id=line96>96
</span><span id=line97>97
</span><span id=line98>98
</span><span id=line99>99
</span><span id=line100>100
</span><span id=line101>101
</span><span id=line102>102
</span><span id=line103>103
</span><span id=line104>104
</span><span id=line105>105
</span><span id=line106>106
</span><span id=line107>107
</span><span id=line108>108
</span><span id=line109>109
</span><span id=line110>110
</span><span id=line111>111
</span><span id=line112>112
</span><span id=line113>113
</span><span id=line114>114
</span><span id=line115>115
</span><span id=line116>116
</span><span id=line117>117
</span><span id=line118>118
</span><span id=line119>119
</span><span id=line120>120
</span><span id=line121>121
</span><span id=line122>122
</span><span id=line123>123
</span><span id=line124>124
</span><span id=line125>125
</span><span id=line126>126
</span><span id=line127>127
</span><span id=line128>128
</span><span id=line129>129
</span><span id=line130>130
</span><span id=line131>131
</span><span id=line132>132
</span><span id=line133>133
</span><span id=line134>134
</span><span id=line135>135
</span><span id=line136>136
</span></pre></td><td><pre>
; Relational interpreter emulating ideas from "Type-and-example-directed program synthesis"
; by 	Peter-Michael Osera	and Steve Zdancewic (http://dl.acm.org/citation.cfm?id=2738007)
; From https://github.com/michaelballantyne/scheme-workshop-2015

<span class=pc2 title="line 5 char 1 count 1">(define empty-env </span><span class=pc2 title="line 5 char 19 count 1">'()</span><span class=pc2 title="line 5 char 1 count 1">)</span>


<span class=pc2 title="line 8 char 1 count 1">(define (lookupo x env t type)</span>
  <span class=pc2 title="line 9 char 3 count 8,890,982">(fresh (y b rest)</span>
    <span class=pc2 title="line 10 char 5 count 5,936,243">(</span><span class=pc2 title="line 10 char 6 count 5,936,243">==</span><span class=pc2 title="line 10 char 5 count 5,936,243"> </span><span class=pc2 title="line 10 char 9 count 5,936,243">`((,</span><span class=pc2 title="line 10 char 13 count 5,936,243">y</span><span class=pc2 title="line 10 char 9 count 5,936,243"> . ,</span><span class=pc2 title="line 10 char 18 count 5,936,243">b</span><span class=pc2 title="line 10 char 9 count 5,936,243">) . ,</span><span class=pc2 title="line 10 char 24 count 5,936,243">rest</span><span class=pc2 title="line 10 char 9 count 5,936,243">)</span><span class=pc2 title="line 10 char 5 count 5,936,243"> </span><span class=pc2 title="line 10 char 30 count 5,936,243">env</span><span class=pc2 title="line 10 char 5 count 5,936,243">)</span>
    <span class=pc2 title="line 11 char 5 count 5,936,243">(conde</span>
      <span class=pc2 title="line 11 char 5 count 5,936,243">(</span><span class=pc2 title="line 12 char 8 count 4,600,053">(</span><span class=pc2 title="line 12 char 9 count 4,600,053">==</span><span class=pc2 title="line 12 char 8 count 4,600,053"> </span><span class=pc2 title="line 12 char 12 count 4,600,053">x</span><span class=pc2 title="line 12 char 8 count 4,600,053"> </span><span class=pc2 title="line 12 char 14 count 4,600,053">y</span><span class=pc2 title="line 12 char 8 count 4,600,053">)</span>
       <span class=pc2 title="line 13 char 8 count 4,600,053">(conde</span>
         <span class=pc2 title="line 13 char 8 count 4,600,053">(</span><span class=pc2 title="line 14 char 11 count 2,769,125">(</span><span class=pc2 title="line 14 char 12 count 2,769,125">==</span><span class=pc2 title="line 14 char 11 count 2,769,125"> </span><span class=pc2 title="line 14 char 15 count 2,769,125">`(val ,</span><span class=pc2 title="line 14 char 22 count 2,769,125">type</span><span class=pc2 title="line 14 char 15 count 2,769,125"> . ,</span><span class=pc2 title="line 14 char 30 count 2,769,125">t</span><span class=pc2 title="line 14 char 15 count 2,769,125">)</span><span class=pc2 title="line 14 char 11 count 2,769,125"> </span><span class=pc2 title="line 14 char 33 count 2,769,125">b</span><span class=pc2 title="line 14 char 11 count 2,769,125">)</span><span class=pc2 title="line 13 char 8 count 4,600,053">)</span>
         <span class=pc2 title="line 13 char 8 count 4,600,053">(</span><span class=pc2 title="line 15 char 11 count 2,607,520">(fresh (lam-expr)</span>
            <span class=pc2 title="line 16 char 13 count 2,549,203">(</span><span class=pc2 title="line 16 char 14 count 2,549,203">==</span><span class=pc2 title="line 16 char 13 count 2,549,203"> </span><span class=pc2 title="line 16 char 17 count 2,549,203">`(rec ,</span><span class=pc2 title="line 16 char 24 count 2,549,203">type</span><span class=pc2 title="line 16 char 17 count 2,549,203"> . ,</span><span class=pc2 title="line 16 char 32 count 2,549,203">lam-expr</span><span class=pc2 title="line 16 char 17 count 2,549,203">)</span><span class=pc2 title="line 16 char 13 count 2,549,203"> </span><span class=pc2 title="line 16 char 42 count 2,549,203">b</span><span class=pc2 title="line 16 char 13 count 2,549,203">)</span>
            <span class=pc2 title="line 17 char 13 count 2,549,203">(</span><span class=pc2 title="line 17 char 14 count 2,549,203">==</span><span class=pc2 title="line 17 char 13 count 2,549,203"> </span><span class=pc2 title="line 17 char 17 count 2,549,203">`(closure ,</span><span class=pc2 title="line 17 char 28 count 2,549,203">lam-expr</span><span class=pc2 title="line 17 char 17 count 2,549,203"> ,</span><span class=pc2 title="line 17 char 38 count 2,549,203">env</span><span class=pc2 title="line 17 char 17 count 2,549,203">)</span><span class=pc2 title="line 17 char 13 count 2,549,203"> </span><span class=pc2 title="line 17 char 43 count 2,549,203">t</span><span class=pc2 title="line 17 char 13 count 2,549,203">)</span><span class=pc2 title="line 15 char 11 count 2,607,520">)</span><span class=pc2 title="line 13 char 8 count 4,600,053">))</span><span class=pc2 title="line 11 char 5 count 5,936,243">)</span>
      <span class=pc2 title="line 11 char 5 count 5,936,243">(</span><span class=pc2 title="line 18 char 8 count 4,560,182">(</span><span class=pc2 title="line 18 char 9 count 4,560,182">=/=</span><span class=pc2 title="line 18 char 8 count 4,560,182"> </span><span class=pc2 title="line 18 char 13 count 4,560,182">x</span><span class=pc2 title="line 18 char 8 count 4,560,182"> </span><span class=pc2 title="line 18 char 15 count 4,560,182">y</span><span class=pc2 title="line 18 char 8 count 4,560,182">)</span>
       <span class=pc2 title="line 19 char 8 count 4,560,182">(</span><span class=pc2 title="line 19 char 9 count 4,560,182">lookupo</span><span class=pc2 title="line 19 char 8 count 4,560,182"> </span><span class=pc2 title="line 19 char 17 count 4,560,182">x</span><span class=pc2 title="line 19 char 8 count 4,560,182"> </span><span class=pc2 title="line 19 char 19 count 4,560,182">rest</span><span class=pc2 title="line 19 char 8 count 4,560,182"> </span><span class=pc2 title="line 19 char 24 count 4,560,182">t</span><span class=pc2 title="line 19 char 8 count 4,560,182"> </span><span class=pc2 title="line 19 char 26 count 4,560,182">type</span><span class=pc2 title="line 19 char 8 count 4,560,182">)</span><span class=pc2 title="line 11 char 5 count 5,936,243">))</span><span class=pc2 title="line 9 char 3 count 8,890,982">)</span><span class=pc2 title="line 8 char 1 count 1">)</span>

<span class=pc2 title="line 21 char 1 count 1">(define (not-in-envo x env)</span>
  <span class=pc2 title="line 22 char 3 count 12,216,835">(conde</span>
    <span class=pc2 title="line 22 char 3 count 12,216,835">(</span><span class=pc2 title="line 23 char 6 count 2,862,335">(</span><span class=pc2 title="line 23 char 7 count 2,862,335">==</span><span class=pc2 title="line 23 char 6 count 2,862,335"> </span><span class=pc2 title="line 23 char 10 count 2,862,335">empty-env</span><span class=pc2 title="line 23 char 6 count 2,862,335"> </span><span class=pc2 title="line 23 char 20 count 2,862,335">env</span><span class=pc2 title="line 23 char 6 count 2,862,335">)</span><span class=pc2 title="line 22 char 3 count 12,216,835">)</span>
    <span class=pc2 title="line 22 char 3 count 12,216,835">(</span><span class=pc2 title="line 24 char 6 count 2,853,629">(fresh (y b rest)</span>
       <span class=pc2 title="line 25 char 8 count 2,627,410">(</span><span class=pc2 title="line 25 char 9 count 2,627,410">==</span><span class=pc2 title="line 25 char 8 count 2,627,410"> </span><span class=pc2 title="line 25 char 12 count 2,627,410">`((,</span><span class=pc2 title="line 25 char 16 count 2,627,410">y</span><span class=pc2 title="line 25 char 12 count 2,627,410"> . ,</span><span class=pc2 title="line 25 char 21 count 2,627,410">b</span><span class=pc2 title="line 25 char 12 count 2,627,410">) . ,</span><span class=pc2 title="line 25 char 27 count 2,627,410">rest</span><span class=pc2 title="line 25 char 12 count 2,627,410">)</span><span class=pc2 title="line 25 char 8 count 2,627,410"> </span><span class=pc2 title="line 25 char 33 count 2,627,410">env</span><span class=pc2 title="line 25 char 8 count 2,627,410">)</span>
       <span class=pc2 title="line 26 char 8 count 2,627,412">(</span><span class=pc2 title="line 26 char 9 count 2,627,412">=/=</span><span class=pc2 title="line 26 char 8 count 2,627,412"> </span><span class=pc2 title="line 26 char 13 count 2,627,412">y</span><span class=pc2 title="line 26 char 8 count 2,627,412"> </span><span class=pc2 title="line 26 char 15 count 2,627,412">x</span><span class=pc2 title="line 26 char 8 count 2,627,412">)</span>
       <span class=pc2 title="line 27 char 8 count 2,627,412">(</span><span class=pc2 title="line 27 char 9 count 2,627,412">not-in-envo</span><span class=pc2 title="line 27 char 8 count 2,627,412"> </span><span class=pc2 title="line 27 char 21 count 2,627,412">x</span><span class=pc2 title="line 27 char 8 count 2,627,412"> </span><span class=pc2 title="line 27 char 23 count 2,627,412">rest</span><span class=pc2 title="line 27 char 8 count 2,627,412">)</span><span class=pc2 title="line 24 char 6 count 2,853,629">)</span><span class=pc2 title="line 22 char 3 count 12,216,835">))</span><span class=pc2 title="line 21 char 1 count 1">)</span>

<span class=pc2 title="line 29 char 1 count 1">(define (list-of-symbolso los)</span>
  <span class=pc2 title="line 30 char 3 count 2,061,578">(conde</span>
    <span class=pc2 title="line 30 char 3 count 2,061,578">(</span><span class=pc2 title="line 31 char 6 count 689,595">(</span><span class=pc2 title="line 31 char 7 count 689,595">==</span><span class=pc2 title="line 31 char 6 count 689,595"> </span><span class=pc2 title="line 31 char 10 count 689,595">'()</span><span class=pc2 title="line 31 char 6 count 689,595"> </span><span class=pc2 title="line 31 char 14 count 689,595">los</span><span class=pc2 title="line 31 char 6 count 689,595">)</span><span class=pc2 title="line 30 char 3 count 2,061,578">)</span>
    <span class=pc2 title="line 30 char 3 count 2,061,578">(</span><span class=pc2 title="line 32 char 6 count 679,803">(fresh (a d)</span>
       <span class=pc2 title="line 33 char 8 count 668,274">(</span><span class=pc2 title="line 33 char 9 count 668,274">==</span><span class=pc2 title="line 33 char 8 count 668,274"> </span><span class=pc2 title="line 33 char 12 count 668,274">`(,</span><span class=pc2 title="line 33 char 15 count 668,274">a</span><span class=pc2 title="line 33 char 12 count 668,274"> . ,</span><span class=pc2 title="line 33 char 20 count 668,274">d</span><span class=pc2 title="line 33 char 12 count 668,274">)</span><span class=pc2 title="line 33 char 8 count 668,274"> </span><span class=pc2 title="line 33 char 23 count 668,274">los</span><span class=pc2 title="line 33 char 8 count 668,274">)</span>
       <span class=pc2 title="line 34 char 8 count 668,274">(</span><span class=pc2 title="line 34 char 9 count 668,274">symbolo</span><span class=pc2 title="line 34 char 8 count 668,274"> </span><span class=pc2 title="line 34 char 17 count 668,274">a</span><span class=pc2 title="line 34 char 8 count 668,274">)</span>
       <span class=pc2 title="line 35 char 8 count 668,274">(</span><span class=pc2 title="line 35 char 9 count 668,274">list-of-symbolso</span><span class=pc2 title="line 35 char 8 count 668,274"> </span><span class=pc2 title="line 35 char 26 count 668,274">d</span><span class=pc2 title="line 35 char 8 count 668,274">)</span><span class=pc2 title="line 32 char 6 count 679,803">)</span><span class=pc2 title="line 30 char 3 count 2,061,578">))</span><span class=pc2 title="line 29 char 1 count 1">)</span>

<span class=pc2 title="line 37 char 1 count 1">(define (eval-listo expr env val type)</span>
  <span class=pc2 title="line 38 char 3 count 5,029,744">(conde</span>
    <span class=pc2 title="line 38 char 3 count 5,029,744">(</span><span class=pc2 title="line 39 char 6 count 985,523">(</span><span class=pc2 title="line 39 char 7 count 985,523">==</span><span class=pc2 title="line 39 char 6 count 985,523"> </span><span class=pc2 title="line 39 char 10 count 985,523">'()</span><span class=pc2 title="line 39 char 6 count 985,523"> </span><span class=pc2 title="line 39 char 14 count 985,523">expr</span><span class=pc2 title="line 39 char 6 count 985,523">)</span>
     <span class=pc2 title="line 40 char 6 count 985,523">(</span><span class=pc2 title="line 40 char 7 count 985,523">==</span><span class=pc2 title="line 40 char 6 count 985,523"> </span><span class=pc2 title="line 40 char 10 count 985,523">'()</span><span class=pc2 title="line 40 char 6 count 985,523"> </span><span class=pc2 title="line 40 char 14 count 985,523">val</span><span class=pc2 title="line 40 char 6 count 985,523">)</span><span class=pc2 title="line 38 char 3 count 5,029,744">)</span>
    <span class=pc2 title="line 38 char 3 count 5,029,744">(</span><span class=pc2 title="line 41 char 6 count 974,960">(fresh (a d v-a v-d t-a t-d)</span>
       <span class=pc2 title="line 42 char 8 count 964,234">(</span><span class=pc2 title="line 42 char 9 count 964,234">==</span><span class=pc2 title="line 42 char 8 count 964,234"> </span><span class=pc2 title="line 42 char 12 count 964,234">`(,</span><span class=pc2 title="line 42 char 15 count 964,234">a</span><span class=pc2 title="line 42 char 12 count 964,234"> . ,</span><span class=pc2 title="line 42 char 20 count 964,234">d</span><span class=pc2 title="line 42 char 12 count 964,234">)</span><span class=pc2 title="line 42 char 8 count 964,234"> </span><span class=pc2 title="line 42 char 23 count 964,234">expr</span><span class=pc2 title="line 42 char 8 count 964,234">)</span>
       <span class=pc2 title="line 43 char 8 count 964,234">(</span><span class=pc2 title="line 43 char 9 count 964,234">==</span><span class=pc2 title="line 43 char 8 count 964,234"> </span><span class=pc2 title="line 43 char 12 count 964,234">`(,</span><span class=pc2 title="line 43 char 15 count 964,234">v-a</span><span class=pc2 title="line 43 char 12 count 964,234"> . ,</span><span class=pc2 title="line 43 char 22 count 964,234">v-d</span><span class=pc2 title="line 43 char 12 count 964,234">)</span><span class=pc2 title="line 43 char 8 count 964,234"> </span><span class=pc2 title="line 43 char 27 count 964,234">val</span><span class=pc2 title="line 43 char 8 count 964,234">)</span>
       <span class=pc2 title="line 44 char 8 count 964,234">(</span><span class=pc2 title="line 44 char 9 count 964,234">==</span><span class=pc2 title="line 44 char 8 count 964,234"> </span><span class=pc2 title="line 44 char 12 count 964,234">`(,</span><span class=pc2 title="line 44 char 15 count 964,234">t-a</span><span class=pc2 title="line 44 char 12 count 964,234"> . ,</span><span class=pc2 title="line 44 char 22 count 964,234">t-d</span><span class=pc2 title="line 44 char 12 count 964,234">)</span><span class=pc2 title="line 44 char 8 count 964,234"> </span><span class=pc2 title="line 44 char 27 count 964,234">type</span><span class=pc2 title="line 44 char 8 count 964,234">)</span>
       <span class=pc2 title="line 45 char 8 count 964,234">(</span><span class=pc2 title="line 45 char 9 count 964,234">eval-expo</span><span class=pc2 title="line 45 char 8 count 964,234"> </span><span class=pc2 title="line 45 char 19 count 964,234">a</span><span class=pc2 title="line 45 char 8 count 964,234"> </span><span class=pc2 title="line 45 char 21 count 964,234">env</span><span class=pc2 title="line 45 char 8 count 964,234"> </span><span class=pc2 title="line 45 char 25 count 964,234">v-a</span><span class=pc2 title="line 45 char 8 count 964,234"> </span><span class=pc2 title="line 45 char 29 count 964,234">'I</span><span class=pc2 title="line 45 char 8 count 964,234"> </span><span class=pc2 title="line 45 char 32 count 964,234">t-a</span><span class=pc2 title="line 45 char 8 count 964,234">)</span>
       <span class=pc2 title="line 46 char 8 count 964,234">(</span><span class=pc2 title="line 46 char 9 count 964,234">eval-listo</span><span class=pc2 title="line 46 char 8 count 964,234"> </span><span class=pc2 title="line 46 char 20 count 964,234">d</span><span class=pc2 title="line 46 char 8 count 964,234"> </span><span class=pc2 title="line 46 char 22 count 964,234">env</span><span class=pc2 title="line 46 char 8 count 964,234"> </span><span class=pc2 title="line 46 char 26 count 964,234">v-d</span><span class=pc2 title="line 46 char 8 count 964,234"> </span><span class=pc2 title="line 46 char 30 count 964,234">t-d</span><span class=pc2 title="line 46 char 8 count 964,234">)</span><span class=pc2 title="line 41 char 6 count 974,960">)</span><span class=pc2 title="line 38 char 3 count 5,029,744">))</span><span class=pc2 title="line 37 char 1 count 1">)</span>

<span class=pc2 title="line 48 char 1 count 1">(define (ext-env*o x* a* t* env out)</span>
  <span class=pc2 title="line 49 char 3 count 5,105,200">(conde</span>
    <span class=pc2 title="line 49 char 3 count 5,105,200">(</span><span class=pc2 title="line 50 char 6 count 1,043,699">(</span><span class=pc2 title="line 50 char 7 count 1,043,699">==</span><span class=pc2 title="line 50 char 6 count 1,043,699"> </span><span class=pc2 title="line 50 char 10 count 1,043,699">'()</span><span class=pc2 title="line 50 char 6 count 1,043,699"> </span><span class=pc2 title="line 50 char 14 count 1,043,699">x*</span><span class=pc2 title="line 50 char 6 count 1,043,699">)</span><span class=pc2 title="line 49 char 3 count 5,105,200"> </span><span class=pc2 title="line 50 char 18 count 1,043,699">(</span><span class=pc2 title="line 50 char 19 count 1,043,699">==</span><span class=pc2 title="line 50 char 18 count 1,043,699"> </span><span class=pc2 title="line 50 char 22 count 1,043,699">'()</span><span class=pc2 title="line 50 char 18 count 1,043,699"> </span><span class=pc2 title="line 50 char 26 count 1,043,699">a*</span><span class=pc2 title="line 50 char 18 count 1,043,699">)</span><span class=pc2 title="line 49 char 3 count 5,105,200"> </span><span class=pc2 title="line 50 char 30 count 1,043,699">(</span><span class=pc2 title="line 50 char 31 count 1,043,699">==</span><span class=pc2 title="line 50 char 30 count 1,043,699"> </span><span class=pc2 title="line 50 char 34 count 1,043,699">env</span><span class=pc2 title="line 50 char 30 count 1,043,699"> </span><span class=pc2 title="line 50 char 38 count 1,043,699">out</span><span class=pc2 title="line 50 char 30 count 1,043,699">)</span><span class=pc2 title="line 49 char 3 count 5,105,200">)</span>
    <span class=pc2 title="line 49 char 3 count 5,105,200">(</span><span class=pc2 title="line 51 char 6 count 1,042,637">(fresh (x a dx* da* env2 t dt*)</span>
       <span class=pc2 title="line 52 char 8 count 1,039,690">(</span><span class=pc2 title="line 52 char 9 count 1,039,690">==</span><span class=pc2 title="line 52 char 8 count 1,039,690"> </span><span class=pc2 title="line 52 char 12 count 1,039,690">`(,</span><span class=pc2 title="line 52 char 15 count 1,039,690">x</span><span class=pc2 title="line 52 char 12 count 1,039,690"> . ,</span><span class=pc2 title="line 52 char 20 count 1,039,690">dx*</span><span class=pc2 title="line 52 char 12 count 1,039,690">)</span><span class=pc2 title="line 52 char 8 count 1,039,690"> </span><span class=pc2 title="line 52 char 25 count 1,039,690">x*</span><span class=pc2 title="line 52 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 53 char 8 count 1,039,690">(</span><span class=pc2 title="line 53 char 9 count 1,039,690">==</span><span class=pc2 title="line 53 char 8 count 1,039,690"> </span><span class=pc2 title="line 53 char 12 count 1,039,690">`(,</span><span class=pc2 title="line 53 char 15 count 1,039,690">a</span><span class=pc2 title="line 53 char 12 count 1,039,690"> . ,</span><span class=pc2 title="line 53 char 20 count 1,039,690">da*</span><span class=pc2 title="line 53 char 12 count 1,039,690">)</span><span class=pc2 title="line 53 char 8 count 1,039,690"> </span><span class=pc2 title="line 53 char 25 count 1,039,690">a*</span><span class=pc2 title="line 53 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 54 char 8 count 1,039,690">(</span><span class=pc2 title="line 54 char 9 count 1,039,690">==</span><span class=pc2 title="line 54 char 8 count 1,039,690"> </span><span class=pc2 title="line 54 char 12 count 1,039,690">`(,</span><span class=pc2 title="line 54 char 15 count 1,039,690">t</span><span class=pc2 title="line 54 char 12 count 1,039,690"> . ,</span><span class=pc2 title="line 54 char 20 count 1,039,690">dt*</span><span class=pc2 title="line 54 char 12 count 1,039,690">)</span><span class=pc2 title="line 54 char 8 count 1,039,690"> </span><span class=pc2 title="line 54 char 25 count 1,039,690">t*</span><span class=pc2 title="line 54 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 55 char 8 count 1,039,690">(</span><span class=pc2 title="line 55 char 9 count 1,039,690">==</span><span class=pc2 title="line 55 char 8 count 1,039,690"> </span><span class=pc2 title="line 55 char 12 count 1,039,690">`((,</span><span class=pc2 title="line 55 char 16 count 1,039,690">x</span><span class=pc2 title="line 55 char 12 count 1,039,690"> . (val ,</span><span class=pc2 title="line 55 char 26 count 1,039,690">t</span><span class=pc2 title="line 55 char 12 count 1,039,690"> . ,</span><span class=pc2 title="line 55 char 31 count 1,039,690">a</span><span class=pc2 title="line 55 char 12 count 1,039,690">)) . ,</span><span class=pc2 title="line 55 char 38 count 1,039,690">env</span><span class=pc2 title="line 55 char 12 count 1,039,690">)</span><span class=pc2 title="line 55 char 8 count 1,039,690"> </span><span class=pc2 title="line 55 char 43 count 1,039,690">env2</span><span class=pc2 title="line 55 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 56 char 8 count 1,039,690">(</span><span class=pc2 title="line 56 char 9 count 1,039,690">symbolo</span><span class=pc2 title="line 56 char 8 count 1,039,690"> </span><span class=pc2 title="line 56 char 17 count 1,039,690">x</span><span class=pc2 title="line 56 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 57 char 8 count 1,039,690">(</span><span class=pc2 title="line 57 char 9 count 1,039,690">symbolo</span><span class=pc2 title="line 57 char 8 count 1,039,690"> </span><span class=pc2 title="line 57 char 17 count 1,039,690">t</span><span class=pc2 title="line 57 char 8 count 1,039,690">)</span>
       <span class=pc2 title="line 58 char 8 count 1,039,690">(</span><span class=pc2 title="line 58 char 9 count 1,039,690">ext-env*o</span><span class=pc2 title="line 58 char 8 count 1,039,690"> </span><span class=pc2 title="line 58 char 19 count 1,039,690">dx*</span><span class=pc2 title="line 58 char 8 count 1,039,690"> </span><span class=pc2 title="line 58 char 23 count 1,039,690">da*</span><span class=pc2 title="line 58 char 8 count 1,039,690"> </span><span class=pc2 title="line 58 char 27 count 1,039,690">dt*</span><span class=pc2 title="line 58 char 8 count 1,039,690"> </span><span class=pc2 title="line 58 char 31 count 1,039,690">env2</span><span class=pc2 title="line 58 char 8 count 1,039,690"> </span><span class=pc2 title="line 58 char 36 count 1,039,690">out</span><span class=pc2 title="line 58 char 8 count 1,039,690">)</span><span class=pc2 title="line 51 char 6 count 1,042,637">)</span><span class=pc2 title="line 49 char 3 count 5,105,200">))</span><span class=pc2 title="line 48 char 1 count 1">)</span>

<span class=pc2 title="line 60 char 1 count 1">(define (evalo expr val)</span>
  <span class=pc2 title="line 61 char 3 count 5">(fresh (type)</span>
    <span class=pc2 title="line 62 char 5 count 166,438">(</span><span class=pc2 title="line 62 char 6 count 166,438">eval-expo</span><span class=pc2 title="line 62 char 5 count 166,438"> </span><span class=pc2 title="line 62 char 16 count 166,438">expr</span><span class=pc2 title="line 62 char 5 count 166,438"> </span><span class=pc2 title="line 62 char 21 count 166,438">empty-env</span><span class=pc2 title="line 62 char 5 count 166,438"> </span><span class=pc2 title="line 62 char 31 count 166,438">val</span><span class=pc2 title="line 62 char 5 count 166,438"> </span><span class=pc2 title="line 62 char 35 count 166,438">'I</span><span class=pc2 title="line 62 char 5 count 166,438"> </span><span class=pc2 title="line 62 char 38 count 166,438">type</span><span class=pc2 title="line 62 char 5 count 166,438">)</span><span class=pc2 title="line 61 char 3 count 5">)</span><span class=pc2 title="line 60 char 1 count 1">)</span>

<span class=pc2 title="line 64 char 1 count 1">(define (eval-expo expr env val EI type)</span>
  <span class=pc2 title="line 65 char 3 count 17,618,929">(conde</span>
    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 66 char 6 count 4,330,800">(</span><span class=pc2 title="line 66 char 7 count 4,330,800">symbolo</span><span class=pc2 title="line 66 char 6 count 4,330,800"> </span><span class=pc2 title="line 66 char 15 count 4,330,800">expr</span><span class=pc2 title="line 66 char 6 count 4,330,800">)</span>
     <span class=pc2 title="line 65 char 3 count 17,618,929">; EI can be either E or I here</span>
     <span class=pc2 title="line 68 char 6 count 4,330,800">(</span><span class=pc2 title="line 68 char 7 count 4,330,800">lookupo</span><span class=pc2 title="line 68 char 6 count 4,330,800"> </span><span class=pc2 title="line 68 char 15 count 4,330,800">expr</span><span class=pc2 title="line 68 char 6 count 4,330,800"> </span><span class=pc2 title="line 68 char 20 count 4,330,800">env</span><span class=pc2 title="line 68 char 6 count 4,330,800"> </span><span class=pc2 title="line 68 char 24 count 4,330,800">val</span><span class=pc2 title="line 68 char 6 count 4,330,800"> </span><span class=pc2 title="line 68 char 28 count 4,330,800">type</span><span class=pc2 title="line 68 char 6 count 4,330,800">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 70 char 6 count 4,294,908">(</span><span class=pc2 title="line 70 char 7 count 4,294,908">==</span><span class=pc2 title="line 70 char 6 count 4,294,908"> </span><span class=pc2 title="line 70 char 10 count 4,294,908">EI</span><span class=pc2 title="line 70 char 6 count 4,294,908"> </span><span class=pc2 title="line 70 char 13 count 4,294,908">'I</span><span class=pc2 title="line 70 char 6 count 4,294,908">)</span>
     <span class=pc2 title="line 71 char 6 count 4,294,908">(</span><span class=pc2 title="line 71 char 7 count 4,294,908">==</span><span class=pc2 title="line 71 char 6 count 4,294,908"> </span><span class=pc2 title="line 71 char 10 count 4,294,908">type</span><span class=pc2 title="line 71 char 6 count 4,294,908"> </span><span class=pc2 title="line 71 char 15 count 4,294,908">'list</span><span class=pc2 title="line 71 char 6 count 4,294,908">)</span>
     <span class=pc2 title="line 72 char 6 count 4,294,908">(</span><span class=pc2 title="line 72 char 7 count 4,294,908">==</span><span class=pc2 title="line 72 char 6 count 4,294,908"> </span><span class=pc2 title="line 72 char 10 count 4,294,908">'(quote ())</span><span class=pc2 title="line 72 char 6 count 4,294,908"> </span><span class=pc2 title="line 72 char 22 count 4,294,908">expr</span><span class=pc2 title="line 72 char 6 count 4,294,908">)</span>
     <span class=pc2 title="line 73 char 6 count 4,294,908">(</span><span class=pc2 title="line 73 char 7 count 4,294,908">==</span><span class=pc2 title="line 73 char 6 count 4,294,908"> </span><span class=pc2 title="line 73 char 10 count 4,294,908">'()</span><span class=pc2 title="line 73 char 6 count 4,294,908"> </span><span class=pc2 title="line 73 char 14 count 4,294,908">val</span><span class=pc2 title="line 73 char 6 count 4,294,908">)</span>
     <span class=pc2 title="line 74 char 6 count 4,294,908">(</span><span class=pc2 title="line 74 char 7 count 4,294,908">not-in-envo</span><span class=pc2 title="line 74 char 6 count 4,294,908"> </span><span class=pc2 title="line 74 char 19 count 4,294,908">'quote</span><span class=pc2 title="line 74 char 6 count 4,294,908"> </span><span class=pc2 title="line 74 char 26 count 4,294,908">env</span><span class=pc2 title="line 74 char 6 count 4,294,908">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 76 char 6 count 4,281,732">(</span><span class=pc2 title="line 76 char 7 count 4,281,732">==</span><span class=pc2 title="line 76 char 6 count 4,281,732"> </span><span class=pc2 title="line 76 char 10 count 4,281,732">EI</span><span class=pc2 title="line 76 char 6 count 4,281,732"> </span><span class=pc2 title="line 76 char 13 count 4,281,732">'I</span><span class=pc2 title="line 76 char 6 count 4,281,732">)</span>
     <span class=pc2 title="line 77 char 6 count 4,281,732">(</span><span class=pc2 title="line 77 char 7 count 4,281,732">==</span><span class=pc2 title="line 77 char 6 count 4,281,732"> </span><span class=pc2 title="line 77 char 10 count 4,281,732">type</span><span class=pc2 title="line 77 char 6 count 4,281,732"> </span><span class=pc2 title="line 77 char 15 count 4,281,732">'list</span><span class=pc2 title="line 77 char 6 count 4,281,732">)</span>
     <span class=pc2 title="line 78 char 6 count 4,281,732">(fresh (e1 e2 v1 v2)</span>
       <span class=pc2 title="line 79 char 8 count 1,153,170">(</span><span class=pc2 title="line 79 char 9 count 1,153,170">==</span><span class=pc2 title="line 79 char 8 count 1,153,170"> </span><span class=pc2 title="line 79 char 12 count 1,153,170">`(cons ,</span><span class=pc2 title="line 79 char 20 count 1,153,170">e1</span><span class=pc2 title="line 79 char 12 count 1,153,170"> ,</span><span class=pc2 title="line 79 char 24 count 1,153,170">e2</span><span class=pc2 title="line 79 char 12 count 1,153,170">)</span><span class=pc2 title="line 79 char 8 count 1,153,170"> </span><span class=pc2 title="line 79 char 28 count 1,153,170">expr</span><span class=pc2 title="line 79 char 8 count 1,153,170">)</span>
       <span class=pc2 title="line 80 char 8 count 1,153,170">(</span><span class=pc2 title="line 80 char 9 count 1,153,170">==</span><span class=pc2 title="line 80 char 8 count 1,153,170"> </span><span class=pc2 title="line 80 char 12 count 1,153,170">`(,</span><span class=pc2 title="line 80 char 15 count 1,153,170">v1</span><span class=pc2 title="line 80 char 12 count 1,153,170"> . ,</span><span class=pc2 title="line 80 char 21 count 1,153,170">v2</span><span class=pc2 title="line 80 char 12 count 1,153,170">)</span><span class=pc2 title="line 80 char 8 count 1,153,170"> </span><span class=pc2 title="line 80 char 25 count 1,153,170">val</span><span class=pc2 title="line 80 char 8 count 1,153,170">)</span>
       <span class=pc2 title="line 81 char 8 count 1,153,170">(</span><span class=pc2 title="line 81 char 9 count 1,153,170">not-in-envo</span><span class=pc2 title="line 81 char 8 count 1,153,170"> </span><span class=pc2 title="line 81 char 21 count 1,153,170">'cons</span><span class=pc2 title="line 81 char 8 count 1,153,170"> </span><span class=pc2 title="line 81 char 27 count 1,153,170">env</span><span class=pc2 title="line 81 char 8 count 1,153,170">)</span>
       <span class=pc2 title="line 82 char 8 count 1,153,170">(</span><span class=pc2 title="line 82 char 9 count 1,153,170">eval-expo</span><span class=pc2 title="line 82 char 8 count 1,153,170"> </span><span class=pc2 title="line 82 char 19 count 1,153,170">e1</span><span class=pc2 title="line 82 char 8 count 1,153,170"> </span><span class=pc2 title="line 82 char 22 count 1,153,170">env</span><span class=pc2 title="line 82 char 8 count 1,153,170"> </span><span class=pc2 title="line 82 char 26 count 1,153,170">v1</span><span class=pc2 title="line 82 char 8 count 1,153,170"> </span><span class=pc2 title="line 82 char 29 count 1,153,170">'I</span><span class=pc2 title="line 82 char 8 count 1,153,170"> </span><span class=pc2 title="line 82 char 32 count 1,153,170">'number</span><span class=pc2 title="line 82 char 8 count 1,153,170">)</span>
       <span class=pc2 title="line 83 char 8 count 1,153,170">(</span><span class=pc2 title="line 83 char 9 count 1,153,170">eval-expo</span><span class=pc2 title="line 83 char 8 count 1,153,170"> </span><span class=pc2 title="line 83 char 19 count 1,153,170">e2</span><span class=pc2 title="line 83 char 8 count 1,153,170"> </span><span class=pc2 title="line 83 char 22 count 1,153,170">env</span><span class=pc2 title="line 83 char 8 count 1,153,170"> </span><span class=pc2 title="line 83 char 26 count 1,153,170">v2</span><span class=pc2 title="line 83 char 8 count 1,153,170"> </span><span class=pc2 title="line 83 char 29 count 1,153,170">'I</span><span class=pc2 title="line 83 char 8 count 1,153,170"> </span><span class=pc2 title="line 83 char 32 count 1,153,170">'list</span><span class=pc2 title="line 83 char 8 count 1,153,170">)</span><span class=pc2 title="line 78 char 6 count 4,281,732">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 85 char 6 count 4,269,113">(fresh (rator x* rands body env^ a* at* res)</span>
       <span class=pc2 title="line 86 char 8 count 4,065,510">(</span><span class=pc2 title="line 86 char 9 count 4,065,510">==</span><span class=pc2 title="line 86 char 8 count 4,065,510"> </span><span class=pc2 title="line 86 char 12 count 4,065,510">`(,</span><span class=pc2 title="line 86 char 15 count 4,065,510">rator</span><span class=pc2 title="line 86 char 12 count 4,065,510"> . ,</span><span class=pc2 title="line 86 char 24 count 4,065,510">rands</span><span class=pc2 title="line 86 char 12 count 4,065,510">)</span><span class=pc2 title="line 86 char 8 count 4,065,510"> </span><span class=pc2 title="line 86 char 31 count 4,065,510">expr</span><span class=pc2 title="line 86 char 8 count 4,065,510">)</span>
       <span class=pc2 title="line 85 char 6 count 4,269,113">; EI can be either E or I here</span>
       <span class=pc2 title="line 88 char 8 count 4,065,510">(</span><span class=pc2 title="line 88 char 9 count 4,065,510">eval-expo</span><span class=pc2 title="line 88 char 8 count 4,065,510"> </span><span class=pc2 title="line 88 char 19 count 4,065,510">rator</span><span class=pc2 title="line 88 char 8 count 4,065,510"> </span><span class=pc2 title="line 88 char 25 count 4,065,510">env</span><span class=pc2 title="line 88 char 8 count 4,065,510"> </span><span class=pc2 title="line 88 char 29 count 4,065,510">`(closure (lambda ,</span><span class=pc2 title="line 88 char 48 count 4,065,510">x*</span><span class=pc2 title="line 88 char 29 count 4,065,510"> ,</span><span class=pc2 title="line 88 char 52 count 4,065,510">body</span><span class=pc2 title="line 88 char 29 count 4,065,510">) ,</span><span class=pc2 title="line 88 char 59 count 4,065,510">env^</span><span class=pc2 title="line 88 char 29 count 4,065,510">)</span><span class=pc2 title="line 88 char 8 count 4,065,510"> </span><span class=pc2 title="line 88 char 65 count 4,065,510">'E</span><span class=pc2 title="line 88 char 8 count 4,065,510"> </span><span class=pc2 title="line 88 char 68 count 4,065,510">`(,</span><span class=pc2 title="line 88 char 71 count 4,065,510">at*</span><span class=pc2 title="line 88 char 68 count 4,065,510"> -&gt; ,</span><span class=pc2 title="line 88 char 79 count 4,065,510">type</span><span class=pc2 title="line 88 char 68 count 4,065,510">)</span><span class=pc2 title="line 88 char 8 count 4,065,510">)</span>
       <span class=pc2 title="line 89 char 8 count 4,065,510">(</span><span class=pc2 title="line 89 char 9 count 4,065,510">eval-listo</span><span class=pc2 title="line 89 char 8 count 4,065,510"> </span><span class=pc2 title="line 89 char 20 count 4,065,510">rands</span><span class=pc2 title="line 89 char 8 count 4,065,510"> </span><span class=pc2 title="line 89 char 26 count 4,065,510">env</span><span class=pc2 title="line 89 char 8 count 4,065,510"> </span><span class=pc2 title="line 89 char 30 count 4,065,510">a*</span><span class=pc2 title="line 89 char 8 count 4,065,510"> </span><span class=pc2 title="line 89 char 33 count 4,065,510">at*</span><span class=pc2 title="line 89 char 8 count 4,065,510">)</span>
       <span class=pc2 title="line 90 char 8 count 4,065,510">(</span><span class=pc2 title="line 90 char 9 count 4,065,510">ext-env*o</span><span class=pc2 title="line 90 char 8 count 4,065,510"> </span><span class=pc2 title="line 90 char 19 count 4,065,510">x*</span><span class=pc2 title="line 90 char 8 count 4,065,510"> </span><span class=pc2 title="line 90 char 22 count 4,065,510">a*</span><span class=pc2 title="line 90 char 8 count 4,065,510"> </span><span class=pc2 title="line 90 char 25 count 4,065,510">at*</span><span class=pc2 title="line 90 char 8 count 4,065,510"> </span><span class=pc2 title="line 90 char 29 count 4,065,510">env^</span><span class=pc2 title="line 90 char 8 count 4,065,510"> </span><span class=pc2 title="line 90 char 34 count 4,065,510">res</span><span class=pc2 title="line 90 char 8 count 4,065,510">)</span>
       <span class=pc2 title="line 91 char 8 count 4,065,510">(</span><span class=pc2 title="line 91 char 9 count 4,065,510">eval-expo</span><span class=pc2 title="line 91 char 8 count 4,065,510"> </span><span class=pc2 title="line 91 char 19 count 4,065,510">body</span><span class=pc2 title="line 91 char 8 count 4,065,510"> </span><span class=pc2 title="line 91 char 24 count 4,065,510">res</span><span class=pc2 title="line 91 char 8 count 4,065,510"> </span><span class=pc2 title="line 91 char 28 count 4,065,510">val</span><span class=pc2 title="line 91 char 8 count 4,065,510"> </span><span class=pc2 title="line 91 char 32 count 4,065,510">'I</span><span class=pc2 title="line 91 char 8 count 4,065,510"> </span><span class=pc2 title="line 91 char 35 count 4,065,510">type</span><span class=pc2 title="line 91 char 8 count 4,065,510">)</span><span class=pc2 title="line 85 char 6 count 4,269,113">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 93 char 6 count 4,090,832">(</span><span class=pc2 title="line 93 char 7 count 4,090,832">==</span><span class=pc2 title="line 93 char 6 count 4,090,832"> </span><span class=pc2 title="line 93 char 10 count 4,090,832">EI</span><span class=pc2 title="line 93 char 6 count 4,090,832"> </span><span class=pc2 title="line 93 char 13 count 4,090,832">'I</span><span class=pc2 title="line 93 char 6 count 4,090,832">)</span>
     <span class=pc2 title="line 94 char 6 count 4,090,832">(fresh (p-name x body letrec-body ftype)</span>
       <span class=pc2 title="line 95 char 8 count 1,393,304">(</span><span class=pc2 title="line 95 char 9 count 1,393,304">==</span><span class=pc2 title="line 95 char 8 count 1,393,304"> </span><span class=pc2 title="line 95 char 12 count 1,393,304">`(letrec ((,</span><span class=pc2 title="line 95 char 24 count 1,393,304">p-name</span><span class=pc2 title="line 95 char 12 count 1,393,304"> (lambda ,</span><span class=pc2 title="line 95 char 40 count 1,393,304">x</span><span class=pc2 title="line 95 char 12 count 1,393,304"> : ,</span><span class=pc2 title="line 95 char 45 count 1,393,304">ftype</span><span class=pc2 title="line 95 char 12 count 1,393,304"> ,</span><span class=pc2 title="line 95 char 52 count 1,393,304">body</span><span class=pc2 title="line 95 char 12 count 1,393,304">)))</span>
              <span class=pc2 title="line 95 char 12 count 1,393,304">,</span><span class=pc2 title="line 96 char 16 count 1,393,304">letrec-body</span><span class=pc2 title="line 95 char 12 count 1,393,304">)</span>
           <span class=pc2 title="line 97 char 12 count 1,393,304">expr</span><span class=pc2 title="line 95 char 8 count 1,393,304">)</span>
       <span class=pc2 title="line 98 char 8 count 1,393,304">(</span><span class=pc2 title="line 98 char 9 count 1,393,304">list-of-symbolso</span><span class=pc2 title="line 98 char 8 count 1,393,304"> </span><span class=pc2 title="line 98 char 26 count 1,393,304">x</span><span class=pc2 title="line 98 char 8 count 1,393,304">)</span>
       <span class=pc2 title="line 99 char 8 count 1,393,304">(</span><span class=pc2 title="line 99 char 9 count 1,393,304">not-in-envo</span><span class=pc2 title="line 99 char 8 count 1,393,304"> </span><span class=pc2 title="line 99 char 21 count 1,393,304">'letrec</span><span class=pc2 title="line 99 char 8 count 1,393,304"> </span><span class=pc2 title="line 99 char 29 count 1,393,304">env</span><span class=pc2 title="line 99 char 8 count 1,393,304">)</span>
       <span class=pc2 title="line 100 char 8 count 1,393,304">(</span><span class=pc2 title="line 100 char 9 count 1,393,304">eval-expo</span><span class=pc2 title="line 100 char 8 count 1,393,304"> </span><span class=pc2 title="line 100 char 19 count 1,393,304">letrec-body</span>
                  <span class=pc2 title="line 101 char 19 count 1,393,304">`((,</span><span class=pc2 title="line 101 char 23 count 1,393,304">p-name</span><span class=pc2 title="line 101 char 19 count 1,393,304"> . (rec ,</span><span class=pc2 title="line 101 char 38 count 1,393,304">ftype</span><span class=pc2 title="line 101 char 19 count 1,393,304"> . (lambda ,</span><span class=pc2 title="line 101 char 55 count 1,393,304">x</span><span class=pc2 title="line 101 char 19 count 1,393,304"> ,</span><span class=pc2 title="line 101 char 58 count 1,393,304">body</span><span class=pc2 title="line 101 char 19 count 1,393,304">))) . ,</span><span class=pc2 title="line 101 char 69 count 1,393,304">env</span><span class=pc2 title="line 101 char 19 count 1,393,304">)</span>
                  <span class=pc2 title="line 102 char 19 count 1,393,304">val</span><span class=pc2 title="line 100 char 8 count 1,393,304"> </span><span class=pc2 title="line 102 char 23 count 1,393,304">'I</span><span class=pc2 title="line 100 char 8 count 1,393,304"> </span><span class=pc2 title="line 102 char 26 count 1,393,304">type</span><span class=pc2 title="line 100 char 8 count 1,393,304">)</span><span class=pc2 title="line 94 char 6 count 4,090,832">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 104 char 6 count 4,050,546">(</span><span class=pc2 title="line 104 char 7 count 4,050,546">==</span><span class=pc2 title="line 104 char 6 count 4,050,546"> </span><span class=pc2 title="line 104 char 10 count 4,050,546">EI</span><span class=pc2 title="line 104 char 6 count 4,050,546"> </span><span class=pc2 title="line 104 char 13 count 4,050,546">'I</span><span class=pc2 title="line 104 char 6 count 4,050,546">)</span>
     <span class=pc2 title="line 105 char 6 count 4,050,546">(fresh (e1 e2 e3 v1 s1 s2)</span>
       <span class=pc2 title="line 106 char 8 count 1,377,409">(</span><span class=pc2 title="line 106 char 9 count 1,377,409">==</span><span class=pc2 title="line 106 char 8 count 1,377,409"> </span><span class=pc2 title="line 106 char 12 count 1,377,409">`(match ,</span><span class=pc2 title="line 106 char 21 count 1,377,409">e1</span>
              <span class=pc2 title="line 106 char 12 count 1,377,409">('() ,</span><span class=pc2 title="line 107 char 21 count 1,377,409">e2</span><span class=pc2 title="line 106 char 12 count 1,377,409">)</span>
              <span class=pc2 title="line 106 char 12 count 1,377,409">((cons ,</span><span class=pc2 title="line 108 char 23 count 1,377,409">s1</span><span class=pc2 title="line 106 char 12 count 1,377,409"> ,</span><span class=pc2 title="line 108 char 27 count 1,377,409">s2</span><span class=pc2 title="line 106 char 12 count 1,377,409">) ,</span><span class=pc2 title="line 108 char 32 count 1,377,409">e3</span><span class=pc2 title="line 106 char 12 count 1,377,409">))</span><span class=pc2 title="line 106 char 8 count 1,377,409"> </span><span class=pc2 title="line 108 char 37 count 1,377,409">expr</span><span class=pc2 title="line 106 char 8 count 1,377,409">)</span>
       <span class=pc2 title="line 109 char 8 count 1,377,409">(</span><span class=pc2 title="line 109 char 9 count 1,377,409">symbolo</span><span class=pc2 title="line 109 char 8 count 1,377,409"> </span><span class=pc2 title="line 109 char 17 count 1,377,409">s1</span><span class=pc2 title="line 109 char 8 count 1,377,409">)</span>
       <span class=pc2 title="line 110 char 8 count 1,377,409">(</span><span class=pc2 title="line 110 char 9 count 1,377,409">symbolo</span><span class=pc2 title="line 110 char 8 count 1,377,409"> </span><span class=pc2 title="line 110 char 17 count 1,377,409">s2</span><span class=pc2 title="line 110 char 8 count 1,377,409">)</span>
       <span class=pc2 title="line 111 char 8 count 1,377,409">(</span><span class=pc2 title="line 111 char 9 count 1,377,409">not-in-envo</span><span class=pc2 title="line 111 char 8 count 1,377,409"> </span><span class=pc2 title="line 111 char 21 count 1,377,409">'match</span><span class=pc2 title="line 111 char 8 count 1,377,409"> </span><span class=pc2 title="line 111 char 28 count 1,377,409">env</span><span class=pc2 title="line 111 char 8 count 1,377,409">)</span>
       <span class=pc2 title="line 112 char 8 count 1,377,409">(</span><span class=pc2 title="line 112 char 9 count 1,377,409">eval-expo</span><span class=pc2 title="line 112 char 8 count 1,377,409"> </span><span class=pc2 title="line 112 char 19 count 1,377,409">e1</span><span class=pc2 title="line 112 char 8 count 1,377,409"> </span><span class=pc2 title="line 112 char 22 count 1,377,409">env</span><span class=pc2 title="line 112 char 8 count 1,377,409"> </span><span class=pc2 title="line 112 char 26 count 1,377,409">v1</span><span class=pc2 title="line 112 char 8 count 1,377,409"> </span><span class=pc2 title="line 112 char 29 count 1,377,409">'E</span><span class=pc2 title="line 112 char 8 count 1,377,409"> </span><span class=pc2 title="line 112 char 32 count 1,377,409">'list</span><span class=pc2 title="line 112 char 8 count 1,377,409">)</span>
       <span class=pc2 title="line 113 char 8 count 1,377,409">(conde</span>
         <span class=pc2 title="line 113 char 8 count 1,377,409">[</span><span class=pc2 title="line 114 char 11 count 250,355">(</span><span class=pc2 title="line 114 char 12 count 250,355">==</span><span class=pc2 title="line 114 char 11 count 250,355"> </span><span class=pc2 title="line 114 char 15 count 250,355">'()</span><span class=pc2 title="line 114 char 11 count 250,355"> </span><span class=pc2 title="line 114 char 19 count 250,355">v1</span><span class=pc2 title="line 114 char 11 count 250,355">)</span>
          <span class=pc2 title="line 115 char 11 count 250,355">(</span><span class=pc2 title="line 115 char 12 count 250,355">eval-expo</span><span class=pc2 title="line 115 char 11 count 250,355"> </span><span class=pc2 title="line 115 char 22 count 250,355">e2</span><span class=pc2 title="line 115 char 11 count 250,355"> </span><span class=pc2 title="line 115 char 25 count 250,355">env</span><span class=pc2 title="line 115 char 11 count 250,355"> </span><span class=pc2 title="line 115 char 29 count 250,355">val</span><span class=pc2 title="line 115 char 11 count 250,355"> </span><span class=pc2 title="line 115 char 33 count 250,355">'I</span><span class=pc2 title="line 115 char 11 count 250,355"> </span><span class=pc2 title="line 115 char 36 count 250,355">type</span><span class=pc2 title="line 115 char 11 count 250,355">)</span><span class=pc2 title="line 113 char 8 count 1,377,409">]</span>
         <span class=pc2 title="line 113 char 8 count 1,377,409">[</span><span class=pc2 title="line 116 char 11 count 250,139">(fresh (a d)</span>
            <span class=pc2 title="line 117 char 13 count 249,532">(</span><span class=pc2 title="line 117 char 14 count 249,532">==</span><span class=pc2 title="line 117 char 13 count 249,532"> </span><span class=pc2 title="line 117 char 17 count 249,532">`(,</span><span class=pc2 title="line 117 char 20 count 249,532">a</span><span class=pc2 title="line 117 char 17 count 249,532"> . ,</span><span class=pc2 title="line 117 char 25 count 249,532">d</span><span class=pc2 title="line 117 char 17 count 249,532">)</span><span class=pc2 title="line 117 char 13 count 249,532"> </span><span class=pc2 title="line 117 char 28 count 249,532">v1</span><span class=pc2 title="line 117 char 13 count 249,532">)</span>
            <span class=pc2 title="line 118 char 13 count 249,532">(</span><span class=pc2 title="line 118 char 14 count 249,532">=/=</span><span class=pc2 title="line 118 char 13 count 249,532"> </span><span class=pc2 title="line 118 char 18 count 249,532">a</span><span class=pc2 title="line 118 char 13 count 249,532"> </span><span class=pc2 title="line 118 char 20 count 249,532">'closure</span><span class=pc2 title="line 118 char 13 count 249,532">)</span>
            <span class=pc2 title="line 119 char 13 count 249,532">(</span><span class=pc2 title="line 119 char 14 count 249,532">eval-expo</span><span class=pc2 title="line 119 char 13 count 249,532"> </span><span class=pc2 title="line 119 char 24 count 249,532">e3</span><span class=pc2 title="line 119 char 13 count 249,532"> </span><span class=pc2 title="line 119 char 27 count 249,532">`((,</span><span class=pc2 title="line 119 char 31 count 249,532">s1</span><span class=pc2 title="line 119 char 27 count 249,532"> . (val number . ,</span><span class=pc2 title="line 119 char 51 count 249,532">a</span><span class=pc2 title="line 119 char 27 count 249,532">)) (,</span><span class=pc2 title="line 119 char 57 count 249,532">s2</span><span class=pc2 title="line 119 char 27 count 249,532"> . (val list . ,</span><span class=pc2 title="line 119 char 75 count 249,532">d</span><span class=pc2 title="line 119 char 27 count 249,532">)) . ,</span><span class=pc2 title="line 119 char 82 count 249,532">env</span><span class=pc2 title="line 119 char 27 count 249,532">)</span><span class=pc2 title="line 119 char 13 count 249,532"> </span><span class=pc2 title="line 119 char 87 count 249,532">val</span><span class=pc2 title="line 119 char 13 count 249,532"> </span><span class=pc2 title="line 119 char 91 count 249,532">'I</span><span class=pc2 title="line 119 char 13 count 249,532"> </span><span class=pc2 title="line 119 char 94 count 249,532">type</span><span class=pc2 title="line 119 char 13 count 249,532">)</span><span class=pc2 title="line 116 char 11 count 250,139">)</span><span class=pc2 title="line 113 char 8 count 1,377,409">])</span><span class=pc2 title="line 105 char 6 count 4,050,546">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 121 char 6 count 4,022,272">(</span><span class=pc2 title="line 121 char 7 count 4,022,272">==</span><span class=pc2 title="line 121 char 6 count 4,022,272"> </span><span class=pc2 title="line 121 char 10 count 4,022,272">EI</span><span class=pc2 title="line 121 char 6 count 4,022,272"> </span><span class=pc2 title="line 121 char 13 count 4,022,272">'I</span><span class=pc2 title="line 121 char 6 count 4,022,272">)</span>
     <span class=pc2 title="line 122 char 6 count 4,022,272">(fresh (e1 e2 e3 e4 v1 v2)</span>
       <span class=pc2 title="line 123 char 8 count 1,370,632">(</span><span class=pc2 title="line 123 char 9 count 1,370,632">==</span><span class=pc2 title="line 123 char 8 count 1,370,632"> </span><span class=pc2 title="line 123 char 12 count 1,370,632">`(if (= ,</span><span class=pc2 title="line 123 char 21 count 1,370,632">e1</span><span class=pc2 title="line 123 char 12 count 1,370,632"> ,</span><span class=pc2 title="line 123 char 25 count 1,370,632">e2</span><span class=pc2 title="line 123 char 12 count 1,370,632">)</span>
              <span class=pc2 title="line 123 char 12 count 1,370,632">,</span><span class=pc2 title="line 124 char 16 count 1,370,632">e3</span>
              <span class=pc2 title="line 123 char 12 count 1,370,632">,</span><span class=pc2 title="line 125 char 16 count 1,370,632">e4</span><span class=pc2 title="line 123 char 12 count 1,370,632">)</span><span class=pc2 title="line 123 char 8 count 1,370,632"> </span><span class=pc2 title="line 125 char 20 count 1,370,632">expr</span><span class=pc2 title="line 123 char 8 count 1,370,632">)</span>
       <span class=pc2 title="line 126 char 8 count 1,370,632">(</span><span class=pc2 title="line 126 char 9 count 1,370,632">not-in-envo</span><span class=pc2 title="line 126 char 8 count 1,370,632"> </span><span class=pc2 title="line 126 char 21 count 1,370,632">'if</span><span class=pc2 title="line 126 char 8 count 1,370,632"> </span><span class=pc2 title="line 126 char 25 count 1,370,632">env</span><span class=pc2 title="line 126 char 8 count 1,370,632">)</span>
       <span class=pc2 title="line 127 char 8 count 1,370,632">(</span><span class=pc2 title="line 127 char 9 count 1,370,632">eval-expo</span><span class=pc2 title="line 127 char 8 count 1,370,632"> </span><span class=pc2 title="line 127 char 19 count 1,370,632">e1</span><span class=pc2 title="line 127 char 8 count 1,370,632"> </span><span class=pc2 title="line 127 char 22 count 1,370,632">env</span><span class=pc2 title="line 127 char 8 count 1,370,632"> </span><span class=pc2 title="line 127 char 26 count 1,370,632">v1</span><span class=pc2 title="line 127 char 8 count 1,370,632"> </span><span class=pc2 title="line 127 char 29 count 1,370,632">'E</span><span class=pc2 title="line 127 char 8 count 1,370,632"> </span><span class=pc2 title="line 127 char 32 count 1,370,632">'number</span><span class=pc2 title="line 127 char 8 count 1,370,632">)</span>
       <span class=pc2 title="line 128 char 8 count 1,370,632">(</span><span class=pc2 title="line 128 char 9 count 1,370,632">eval-expo</span><span class=pc2 title="line 128 char 8 count 1,370,632"> </span><span class=pc2 title="line 128 char 19 count 1,370,632">e2</span><span class=pc2 title="line 128 char 8 count 1,370,632"> </span><span class=pc2 title="line 128 char 22 count 1,370,632">env</span><span class=pc2 title="line 128 char 8 count 1,370,632"> </span><span class=pc2 title="line 128 char 26 count 1,370,632">v2</span><span class=pc2 title="line 128 char 8 count 1,370,632"> </span><span class=pc2 title="line 128 char 29 count 1,370,632">'E</span><span class=pc2 title="line 128 char 8 count 1,370,632"> </span><span class=pc2 title="line 128 char 32 count 1,370,632">'number</span><span class=pc2 title="line 128 char 8 count 1,370,632">)</span>
       <span class=pc2 title="line 129 char 8 count 1,370,632">(conde</span>
         <span class=pc2 title="line 129 char 8 count 1,370,632">[</span><span class=pc2 title="line 130 char 11 count 19,536">(</span><span class=pc2 title="line 130 char 12 count 19,536">==</span><span class=pc2 title="line 130 char 11 count 19,536"> </span><span class=pc2 title="line 130 char 15 count 19,536">v1</span><span class=pc2 title="line 130 char 11 count 19,536"> </span><span class=pc2 title="line 130 char 18 count 19,536">v2</span><span class=pc2 title="line 130 char 11 count 19,536">)</span>
          <span class=pc2 title="line 131 char 11 count 19,536">(</span><span class=pc2 title="line 131 char 12 count 19,536">eval-expo</span><span class=pc2 title="line 131 char 11 count 19,536"> </span><span class=pc2 title="line 131 char 22 count 19,536">e3</span><span class=pc2 title="line 131 char 11 count 19,536"> </span><span class=pc2 title="line 131 char 25 count 19,536">env</span><span class=pc2 title="line 131 char 11 count 19,536"> </span><span class=pc2 title="line 131 char 29 count 19,536">val</span><span class=pc2 title="line 131 char 11 count 19,536"> </span><span class=pc2 title="line 131 char 33 count 19,536">'I</span><span class=pc2 title="line 131 char 11 count 19,536"> </span><span class=pc2 title="line 131 char 36 count 19,536">type</span><span class=pc2 title="line 131 char 11 count 19,536">)</span><span class=pc2 title="line 129 char 8 count 1,370,632">]</span>
         <span class=pc2 title="line 129 char 8 count 1,370,632">[</span><span class=pc2 title="line 132 char 11 count 19,497">(</span><span class=pc2 title="line 132 char 12 count 19,497">=/=</span><span class=pc2 title="line 132 char 11 count 19,497"> </span><span class=pc2 title="line 132 char 16 count 19,497">v1</span><span class=pc2 title="line 132 char 11 count 19,497"> </span><span class=pc2 title="line 132 char 19 count 19,497">v2</span><span class=pc2 title="line 132 char 11 count 19,497">)</span>
          <span class=pc2 title="line 133 char 11 count 19,497">(</span><span class=pc2 title="line 133 char 12 count 19,497">eval-expo</span><span class=pc2 title="line 133 char 11 count 19,497"> </span><span class=pc2 title="line 133 char 22 count 19,497">e4</span><span class=pc2 title="line 133 char 11 count 19,497"> </span><span class=pc2 title="line 133 char 25 count 19,497">env</span><span class=pc2 title="line 133 char 11 count 19,497"> </span><span class=pc2 title="line 133 char 29 count 19,497">val</span><span class=pc2 title="line 133 char 11 count 19,497"> </span><span class=pc2 title="line 133 char 33 count 19,497">'I</span><span class=pc2 title="line 133 char 11 count 19,497"> </span><span class=pc2 title="line 133 char 36 count 19,497">type</span><span class=pc2 title="line 133 char 11 count 19,497">)</span><span class=pc2 title="line 129 char 8 count 1,370,632">])</span>
       <span class=pc2 title="line 122 char 6 count 4,022,272">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">)</span>

    <span class=pc2 title="line 65 char 3 count 17,618,929">(</span><span class=pc2 title="line 136 char 6 count 4,009,069">(</span><span class=pc2 title="line 136 char 7 count 4,009,069">==</span><span class=pc2 title="line 136 char 6 count 4,009,069"> </span><span class=pc2 title="line 136 char 10 count 4,009,069">EI</span><span class=pc2 title="line 136 char 6 count 4,009,069"> </span><span class=pc2 title="line 136 char 13 count 4,009,069">'I</span><span class=pc2 title="line 136 char 6 count 4,009,069">)</span><span class=pc2 title="line 65 char 3 count 17,618,929"> </span><span class=pc2 title="line 136 char 17 count 4,009,069">(</span><span class=pc2 title="line 136 char 18 count 4,009,069">==</span><span class=pc2 title="line 136 char 17 count 4,009,069"> </span><span class=pc2 title="line 136 char 21 count 4,009,069">type</span><span class=pc2 title="line 136 char 17 count 4,009,069"> </span><span class=pc2 title="line 136 char 26 count 4,009,069">'number</span><span class=pc2 title="line 136 char 17 count 4,009,069">)</span><span class=pc2 title="line 65 char 3 count 17,618,929"> </span><span class=pc2 title="line 136 char 35 count 4,009,069">(</span><span class=pc2 title="line 136 char 36 count 4,009,069">numbero</span><span class=pc2 title="line 136 char 35 count 4,009,069"> </span><span class=pc2 title="line 136 char 44 count 4,009,069">expr</span><span class=pc2 title="line 136 char 35 count 4,009,069">)</span><span class=pc2 title="line 65 char 3 count 17,618,929"> </span><span class=pc2 title="line 136 char 50 count 4,009,069">(</span><span class=pc2 title="line 136 char 51 count 4,009,069">==</span><span class=pc2 title="line 136 char 50 count 4,009,069"> </span><span class=pc2 title="line 136 char 54 count 4,009,069">expr</span><span class=pc2 title="line 136 char 50 count 4,009,069"> </span><span class=pc2 title="line 136 char 59 count 4,009,069">val</span><span class=pc2 title="line 136 char 50 count 4,009,069">)</span><span class=pc2 title="line 65 char 3 count 17,618,929">))</span><span class=pc2 title="line 64 char 1 count 1">)</span>
</pre></td></tr></table>
</body>
</html>